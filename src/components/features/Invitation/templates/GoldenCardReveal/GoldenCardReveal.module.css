/* ============================================
   GOLDEN CARD REVEAL â€” CSS MODULE

   Premium 3D flip card with wax seal break,
   confetti burst, and cursor-tracking tilt.

   Theme tokens are injected via inline styles
   using var(--gcr-*) variables.
   ============================================ */

/* ============================================
   ROOT (receives theme tokens inline)
   ============================================ */
.root {
  /* Tilt effect variables (controlled by JS) */
  --tilt-x: 0deg;
  --tilt-y: 0deg;
  --glare-x: 50%;
  --glare-y: 50%;
  --glare-opacity: 0;
}

/* ============================================
   STAGE (Container)
   ============================================ */
.stage {
  position: relative;
  width: min(380px, 85vw);
  aspect-ratio: 5/7;
  transform-style: preserve-3d;
  margin: 0 auto;
}

/* Surface shadow beneath card */
.stage::before {
  content: "";
  position: absolute;
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%) rotateX(90deg);
  width: 90%;
  height: 60px;
  background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.4) 0%, transparent 70%);
  filter: blur(8px);
  pointer-events: none;
}

/* ============================================
   CARD (Button wrapper)
   ============================================ */
.card {
  --duration: 1400ms;
  --easing: cubic-bezier(0.23, 1, 0.32, 1);

  position: absolute;
  inset: 0;
  cursor: pointer;
  border: none;
  padding: 0;
  background: transparent;
  outline: none;
  transform-style: preserve-3d;
  transition: transform 0.15s ease-out;
  transform: rotateX(var(--tilt-x)) rotateY(var(--tilt-y));
}

.card:focus-visible {
  outline: 3px solid var(--gcr-card-border);
  outline-offset: 8px;
  border-radius: 12px;
}

/* ============================================
   CARD WRAPPER (Flip container)
   ============================================ */
.cardWrapper {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform var(--duration) var(--easing);
  transform-origin: 75% 50%;
}

.cardContent {
  display: block;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform var(--duration) var(--easing);
}

/* ============================================
   CARD FACES
   ============================================ */
.cardFace {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  border-radius: 12px;
  overflow: hidden;
  box-shadow:
    0 4px 20px rgba(0, 0, 0, 0.2),
    0 8px 40px var(--gcr-card-shadow),
    inset 0 0 0 1px var(--gcr-card-border);
}

/* --- BACK FACE (Sealed) --- */
.cardBack {
  background: var(--gcr-card-bg);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Damask pattern */
.cardBack::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 5 L35 15 L45 15 L37 22 L40 32 L30 26 L20 32 L23 22 L15 15 L25 15 Z' fill='%23d4af37' fill-opacity='0.08'/%3E%3Cpath d='M30 35 L33 42 L40 42 L35 47 L37 54 L30 50 L23 54 L25 47 L20 42 L27 42 Z' fill='%23d4af37' fill-opacity='0.06'/%3E%3Ccircle cx='10' cy='30' r='3' fill='%23d4af37' fill-opacity='0.05'/%3E%3Ccircle cx='50' cy='30' r='3' fill='%23d4af37' fill-opacity='0.05'/%3E%3C/svg%3E");
  background-size: 60px 60px;
  opacity: 0.8;
}

/* Ornate border frame */
.cardBack::after {
  content: "";
  position: absolute;
  inset: 12px;
  border: 2px solid var(--gcr-damask-accent);
  border-radius: 8px;
  background:
    linear-gradient(90deg, var(--gcr-damask-accent) 1px, transparent 1px) 0 0 / 8px 8px,
    linear-gradient(var(--gcr-damask-accent) 1px, transparent 1px) 0 0 / 8px 8px;
  background-position: -4px -4px;
  mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  mask-composite: exclude;
  padding: 4px;
}

/* --- FRONT FACE (Revealed) --- */
.cardFront {
  background: var(--gcr-card-bg);
  transform: rotateY(180deg);
  display: flex;
  flex-direction: column;
  padding: 1.5rem;
}

/* Subtle border on front */
.cardFront::before {
  content: "";
  position: absolute;
  inset: 10px;
  border: 1px solid var(--gcr-damask-color);
  border-radius: 6px;
  pointer-events: none;
}

/* ============================================
   CORNER FLOURISHES
   ============================================ */
.cornerFlourish {
  position: absolute;
  width: 50px;
  height: 50px;
  opacity: 0.4;
  color: var(--gcr-card-border);
}

.cornerFlourish svg {
  width: 100%;
  height: 100%;
  fill: currentColor;
}

.topLeft {
  top: 20px;
  left: 20px;
}

.topRight {
  top: 20px;
  right: 20px;
  transform: scaleX(-1);
}

.bottomLeft {
  bottom: 20px;
  left: 20px;
  transform: scaleY(-1);
}

.bottomRight {
  bottom: 20px;
  right: 20px;
  transform: scale(-1);
}

/* ============================================
   WAX SEAL
   ============================================ */
.sealContainer {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 10;
}

.seal {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: var(--gcr-seal-bg);
  --shadow-x: 0px;
  --shadow-y: 2px;
  box-shadow:
    var(--shadow-x) var(--shadow-y) 8px rgba(0, 0, 0, 0.3),
    calc(var(--shadow-x) * 1.5) calc(var(--shadow-y) * 1.5) 16px rgba(0, 0, 0, 0.2),
    inset 0 2px 4px rgba(255, 255, 255, 0.3),
    inset 0 -2px 4px rgba(0, 0, 0, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  transition: transform 0.3s ease, box-shadow 0.15s ease-out;
}

.seal:hover {
  transform: scale(1.05);
}

/* Seal emboss effect */
.seal::before {
  content: "";
  position: absolute;
  inset: 4px;
  border-radius: 50%;
  border: 2px solid var(--gcr-seal-border);
  opacity: 0.5;
}

.sealMonogram {
  font-family: var(--inv-font-script, "Cormorant Garamond", serif);
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--gcr-seal-text);
  text-shadow: 0 1px 1px rgba(255, 255, 255, 0.3);
  letter-spacing: -2px;
}

/* Seal glow pulse */
.sealGlow {
  position: absolute;
  inset: -8px;
  border-radius: 50%;
  background: radial-gradient(circle, var(--gcr-shimmer-color) 0%, transparent 70%);
  animation: sealPulse 2s ease-in-out infinite;
  pointer-events: none;
}

@keyframes sealPulse {
  0%, 100% {
    opacity: 0.3;
    transform: scale(1);
  }
  50% {
    opacity: 0.7;
    transform: scale(1.1);
  }
}

/* Seal glow state control */
.flipped .sealGlow,
.breaking .sealGlow {
  animation: none;
  opacity: 0;
}

/* ============================================
   TAP HINT
   ============================================ */
.tapHint {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  font-family: var(--inv-font-body, "Montserrat", sans-serif);
  font-size: 0.65rem;
  color: var(--gcr-text-secondary);
  text-transform: uppercase;
  letter-spacing: 2px;
  white-space: nowrap;
  animation: hintFade 2s ease-in-out infinite;
  background: rgba(255, 255, 255, 0.7);
  padding: 6px 12px;
  border-radius: 12px;
  backdrop-filter: blur(4px);
}

@keyframes hintFade {
  0%, 100% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
}

/* Hide tap hint when flipped */
.flipped .tapHint {
  opacity: 0 !important;
  animation: none;
}

/* ============================================
   SEAL HALVES (Break animation)
   ============================================ */
.sealHalf {
  position: absolute;
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: var(--gcr-seal-bg);
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.3),
    inset 0 2px 4px rgba(255, 255, 255, 0.3);
  opacity: 0;
  pointer-events: none;
  top: 50%;
  left: 50%;
}

.sealHalfLeft {
  clip-path: polygon(0 0, 50% 0, 50% 100%, 0 100%);
  transform: translate(-50%, -50%);
}

.sealHalfRight {
  clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
  transform: translate(-50%, -50%);
}

/* Breaking state */
.breaking .seal {
  opacity: 0;
  transition: opacity 0.1s;
}

.breaking .sealHalf {
  opacity: 1;
}

.breaking .sealHalfLeft {
  animation: sealBreakLeft 0.8s ease-out forwards;
}

.breaking .sealHalfRight {
  animation: sealBreakRight 0.8s ease-out forwards;
}

/* When closing, seal reappears */
.card:not(.breaking) .seal {
  opacity: 1;
  transition: opacity 0.3s ease 0.5s;
}

.card:not(.breaking) .sealHalf {
  opacity: 0;
  animation: none;
  transform: translate(-50%, -50%);
}

@keyframes sealBreakLeft {
  0% {
    transform: translate(-50%, -50%) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translate(-150%, -200%) rotate(-45deg);
    opacity: 0;
  }
}

@keyframes sealBreakRight {
  0% {
    transform: translate(-50%, -50%) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translate(50%, -200%) rotate(45deg);
    opacity: 0;
  }
}

/* ============================================
   INVITATION CONTENT
   ============================================ */
.invitationContent {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 0.6s ease, transform 0.6s ease;
  transition-delay: 0.8s;
}

.flipped .invitationContent {
  opacity: 1;
  transform: translateY(0);
}

/* When closing, fade out */
.card:not(.flipped) .invitationContent {
  opacity: 0;
  transform: translateY(10px);
  transition-delay: 0s;
}

.invitationHeader {
  font-family: var(--inv-font-body, "Montserrat", sans-serif);
  font-size: 0.65rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 4px;
  color: var(--gcr-text-accent);
  margin-bottom: 0.75rem;
}

.coupleNames {
  font-family: var(--inv-font-script, "Cormorant Garamond", serif);
  font-size: clamp(1.6rem, 6vw, 2.2rem);
  font-weight: 400;
  color: var(--gcr-text-primary);
  line-height: 1.2;
  margin: 0 0 0.5rem 0;
}

.ampersand {
  font-style: italic;
  color: var(--gcr-text-accent);
  margin: 0 0.25rem;
}

.invitationPhoto {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--gcr-card-border);
  margin: 1rem 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.eventDetails {
  margin: 0.75rem 0;
}

.eventDate {
  font-family: var(--inv-font-script, "Cormorant Garamond", serif);
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--gcr-text-primary);
  margin: 0 0 0.25rem 0;
}

.eventTime {
  font-family: var(--inv-font-body, sans-serif);
  font-size: 0.75rem;
  color: var(--gcr-text-secondary);
  margin: 0 0 0.5rem 0;
}

.eventVenue {
  font-family: var(--inv-font-body, sans-serif);
  font-size: 0.8rem;
  color: var(--gcr-text-secondary);
  line-height: 1.5;
  margin: 0;
}

.venueName {
  display: block;
  color: var(--gcr-text-primary);
  font-weight: 500;
}

.rsvpButton {
  margin-top: 1rem;
  padding: 0.6rem 1.5rem;
  background: var(--gcr-seal-bg);
  color: var(--gcr-seal-text);
  border: none;
  border-radius: 24px;
  font-family: var(--inv-font-body, "Montserrat", sans-serif);
  font-size: 0.7rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 2px;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  text-decoration: none;
  display: inline-block;
}

.rsvpButton:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25);
}

.rsvpButton:active {
  transform: translateY(0);
}

/* ============================================
   GLARE EFFECT
   ============================================ */
.cardGlare {
  position: absolute;
  inset: 0;
  border-radius: 12px;
  pointer-events: none;
  z-index: 100;
  opacity: var(--glare-opacity);
  transition: opacity 0.3s ease;
  background: radial-gradient(
    circle at var(--glare-x) var(--glare-y),
    rgba(255, 248, 220, 0.5) 0%,
    rgba(255, 215, 0, 0.1) 30%,
    transparent 60%
  );
  mix-blend-mode: overlay;
}

/* Front face glare - mirrored coordinates */
.cardFront .cardGlare {
  background: radial-gradient(
    circle at calc(100% - var(--glare-x)) var(--glare-y),
    rgba(255, 248, 220, 0.45) 0%,
    rgba(255, 215, 0, 0.08) 30%,
    transparent 55%
  );
}

/* ============================================
   FLIPPED STATE
   ============================================ */
.flipped .cardWrapper {
  transform: rotateY(-180deg);
}

.flipped .sealContainer {
  opacity: 0;
  transition: opacity 0.3s ease 0.2s;
}

/* When closing */
.card:not(.flipped) .sealContainer {
  opacity: 1;
  transition: opacity 0.3s ease 0.8s;
}

/* ============================================
   CONFETTI
   ============================================ */
.confettiContainer {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1000;
  overflow: hidden;
}

.confetti {
  position: absolute;
  width: 10px;
  height: 10px;
  opacity: 0;
}

.confettiCircle {
  border-radius: 50%;
}

.confettiSquare {
  border-radius: 2px;
}

.confettiStar {
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
}

/* ============================================
   REPLAY BUTTON
   ============================================ */
.replayButton {
  position: absolute;
  top: 1rem;
  right: 1rem;
  padding: 0.5rem 1rem;
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid var(--gcr-card-border);
  border-radius: 20px;
  font-family: var(--inv-font-body, sans-serif);
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--gcr-text-primary);
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
  z-index: 50;
  display: flex;
  align-items: center;
  gap: 0.4rem;
}

.replayButton:hover {
  background: rgba(255, 255, 255, 1);
  transform: scale(1.05);
}

.replayButton svg {
  width: 14px;
  height: 14px;
}

/* ============================================
   REDUCED MOTION
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  .cardWrapper {
    transition: none;
  }

  .flipped .cardWrapper {
    transform: rotateY(-180deg);
  }

  .card {
    transform: none !important;
  }

  .cardGlare {
    display: none;
  }

  .sealGlow,
  .tapHint {
    animation: none;
  }

  .breaking .sealHalfLeft,
  .breaking .sealHalfRight {
    animation: none;
  }

  .invitationContent {
    transition: none;
  }
}

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 480px) {
  .stage {
    width: 90vw;
  }

  .cardFront {
    padding: 1rem;
  }

  .invitationPhoto {
    width: 80px;
    height: 80px;
  }

  .seal,
  .sealHalf {
    width: 70px;
    height: 70px;
  }

  .sealMonogram {
    font-size: 1.5rem;
  }
}
